<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>메디셜 영양제 체크</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">
<meta property="og:title" content="메디셜 영양제 체크">
<meta property="og:description" content="매일 건강에 한걸음 나아가고 적립금도 받아가세요!">
<meta property="og:image" content="https://gold9-app.github.io/meditial-check/%EC%9D%B4%EB%AF%B8%EC%A7%80/%EC%95%B1-OG-%EC%9D%B4%EB%AF%B8%EC%A7%80.png">
<meta property="og:url" content="https://gold9-app.github.io/meditial-check/">
<meta property="og:type" content="website">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="영양제체크">
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" type="image/png" href="icon.png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>
<main class="app">
  <!-- Welcome Overlay -->
  <div class="welcome-overlay" id="welcomeOverlay" style="display:none;">
    <div class="welcome-box">
      <div class="welcome-icon">💊</div>
      <div class="welcome-title">MEDITIAL</div>
      <div class="welcome-desc">매일 건강에 한걸음 나아가고<br>적립금도 받아가세요!</div>

      <!-- 1단계: 카카오 로그인 -->
      <div id="loginStep1">
        <button class="kakao-login-btn" onclick="openKakaoLogin()">
          <img src="카카오로그인.png" alt="카카오 로그인">
        </button>
        <p class="login-hint">메디셜 회원가입/로그인 페이지로 이동합니다</p>
        <p class="login-hint-warning">로그인 완료 후 열린 창을 닫으면<br><strong>앱이 실행됩니다!</strong></p>
      </div>

      <!-- 2단계: 정보 입력 -->
      <div id="loginStep2" style="display:none;">
        <div class="profile-setup">
          <div class="profile-setup-title">프로필 설정</div>
          <div class="profile-setup-desc">앱에서 사용할 정보를 입력해주세요</div>

          <div class="profile-field">
            <label for="nicknameInput">닉네임</label>
            <input type="text" id="nicknameInput" placeholder="닉네임을 입력하세요" maxlength="10">
          </div>

          <div class="profile-field">
            <label for="birthdayInput">생년월일</label>
            <input type="date" id="birthdayInput">
          </div>

          <button class="profile-submit-btn" onclick="saveProfile()">시작하기</button>
        </div>
      </div>
    </div>
  </div>

  <header class="header">
    <div class="header-top">
      <div class="header-info">
        <h1>MEDITIAL 영양제 체크</h1>
        <span id="nicknameDisplay"></span>
        <div class="date" id="headerDate"></div>
      </div>
      <button class="dark-toggle" id="darkToggle" onclick="toggleDarkMode()" aria-label="다크모드 전환">
        <span id="darkIcon">🌙</span>
      </button>
    </div>
    <div class="header-bottom">
      <div class="header-progress" id="headerProgress"></div>
      <span id="streakBadge"></span>
    </div>
    <div id="savingsTrack"></div>
  </header>

  <div class="event-ticker" id="eventTicker"></div>

  <div class="notif-banner" id="notifBanner" onclick="requestNotifPermission()">
    알림받고 적립 꾸준히 하기! 여기를 클릭하세요.
  </div>

  <div class="tab-content active" id="today" role="tabpanel" aria-label="오늘 복용">
    <div id="dateNav"></div>
    <div id="todayList"></div>
    <a href="https://meditial.co.kr/" target="_blank" class="cta-btn"><span class="cta-label">다 드셨나요?</span><span class="cta-click">Click!</span></a>
    <div class="guide-section">
      <button class="guide-toggle" onclick="toggleGuide(this)" aria-label="사용법 안내 펼치기" aria-expanded="false">
        <span>사용법 안내</span>
        <span class="arrow">▼</span>
      </button>
      <div class="guide-body" id="guideBody">
        <div class="guide-notice">이 앱은 <strong>홈 화면에 설치</strong>해서 사용해야 해요!<br>아래 방법으로 먼저 설치해 주세요.</div>

        <div class="guide-section-title">아이폰 (iPhone) 설치 방법</div>
        <div class="guide-step">
          <div class="guide-num">1</div>
          <div class="guide-text"><strong>Safari</strong>에서 이 페이지를 열어요</div>
        </div>
        <div class="guide-step">
          <div class="guide-num">2</div>
          <div class="guide-text">화면 아래 <strong>공유 버튼</strong>을 눌러요</div>
        </div>
        <div class="guide-step">
          <div class="guide-num">3</div>
          <div class="guide-text"><strong>홈 화면에 추가</strong>를 눌러요</div>
        </div>

        <div class="guide-section-title">갤럭시 (Android) 설치 방법</div>
        <div class="guide-step">
          <div class="guide-num">1</div>
          <div class="guide-text"><strong>Chrome</strong>에서 이 페이지를 열어요</div>
        </div>
        <div class="guide-step">
          <div class="guide-num">2</div>
          <div class="guide-text">화면 위 <strong>점 세 개 메뉴</strong>를 눌러요</div>
        </div>
        <div class="guide-step">
          <div class="guide-num">3</div>
          <div class="guide-text"><strong>홈 화면에 추가</strong>를 눌러요</div>
        </div>

        <div class="guide-divider"></div>
        <div class="guide-section-title">앱 사용법</div>
        <div class="guide-step">
          <div class="guide-num">1</div>
          <div class="guide-text">아래 <strong>관리</strong> 탭에서 <strong>+ 영양제 추가</strong>를 눌러 등록해요</div>
        </div>
        <div class="guide-step">
          <div class="guide-num">2</div>
          <div class="guide-text"><strong>오늘</strong> 탭에서 영양제를 먹으면 <strong>동그란 버튼</strong>을 눌러 체크해요</div>
        </div>
        <div class="guide-step">
          <div class="guide-num">3</div>
          <div class="guide-text"><strong>통계</strong> 탭에서 내 기록을 확인할 수 있어요</div>
        </div>
        <div class="guide-step">
          <div class="guide-num">4</div>
          <div class="guide-text">재고가 <strong>3일분 이하</strong>가 되면 <strong>빨간색</strong>으로 알려줘요</div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-content" id="stats" role="tabpanel" aria-label="통계">
    <div id="savingsHero"></div>
    <div class="stat-period">
      <button class="period-btn active" data-days="7" aria-label="최근 7일 통계">최근 7일</button>
      <button class="period-btn" data-days="30" aria-label="최근 30일 통계">최근 30일</button>
    </div>
    <div class="stat-summary" id="statSummary"></div>
    <div class="chart-section">
      <h3>영양제별 복용률</h3>
      <div id="chartBars"></div>
    </div>
    <div class="calendar-section">
      <h3>복용 캘린더</h3>
      <div id="calendarHeatmap"></div>
    </div>
    <div id="badgeSection"></div>
  </div>

  <div class="tab-content" id="manage" role="tabpanel" aria-label="관리">
    <div class="manage-group">
      <h3 class="manage-group-title">내 영양제 관리</h3>
      <button class="add-btn" onclick="openModal()">+ 영양제 추가</button>
      <div id="manageList"></div>
    </div>
    <div class="manage-group">
      <h3 class="manage-group-title">내 정보</h3>
      <div class="nickname-section" id="nicknameSection">
        <div>
          <span class="nickname-label">이름: </span>
          <span class="nickname-value" id="nicknameValue"></span>
        </div>
      </div>
      <div class="nickname-section" id="birthdaySection">
        <div>
          <span class="nickname-label">생년월일: </span>
          <span class="nickname-value" id="birthdayValue">미설정</span>
        </div>
      </div>
    </div>
    <div class="reset-section">
      <button class="reset-btn" onclick="resetApp()">🔄 앱 초기화</button>
    </div>
  </div>

  <div class="tab-content" id="event" role="tabpanel" aria-label="이벤트">
    <div class="event-sub-tabs">
      <button class="event-sub-tab active" data-sub="eventList">이벤트</button>
      <button class="event-sub-tab" data-sub="noticeList">공지</button>
    </div>
    <div class="event-sub-content active" id="eventList">
      <div class="event-list" id="eventListInner"></div>
    </div>
    <div class="event-sub-content" id="noticeList">
      <div class="event-list" id="noticeListInner"></div>
    </div>
  </div>
</main>

<div class="update-banner" id="updateBanner" style="display:none" onclick="location.reload()">
  새 버전이 있습니다. 여기를 눌러 업데이트하세요!
</div>

<!-- Bottom Navigation -->
<nav class="bottom-nav" role="tablist">
  <button class="nav-item active" data-tab="today" role="tab" aria-label="오늘 복용">
    <span class="nav-icon">💊</span>
    <span class="nav-label">오늘</span>
  </button>
  <button class="nav-item" data-tab="stats" role="tab" aria-label="통계">
    <span class="nav-icon">📊</span>
    <span class="nav-label">통계</span>
  </button>
  <button class="nav-item" data-tab="manage" role="tab" aria-label="관리">
    <span class="nav-icon">⚙️</span>
    <span class="nav-label">관리</span>
  </button>
  <button class="nav-item" data-tab="event" role="tab" aria-label="이벤트">
    <span class="nav-icon">📢</span>
    <span class="nav-label">이벤트</span>
  </button>
</nav>

<!-- Repurchase Popup -->
<div class="repurchase-overlay" id="repurchasePopup">
  <div class="repurchase-content">
    <span class="repurchase-icon">💊</span>
    <div class="repurchase-title">재고가 소진되었어요!</div>
    <div class="repurchase-name" id="repurchaseName"></div>
    <div class="repurchase-desc">건강 더 챙겨보실래요?</div>
    <a class="repurchase-buy" href="https://meditial.co.kr/" target="_blank" onclick="closeRepurchasePopup()">혜택받고 재구매</a>
    <button class="repurchase-close" onclick="closeRepurchasePopup()">닫기</button>
  </div>
</div>

<!-- Event Detail -->
<div class="event-detail-overlay" id="eventDetailOverlay">
  <div class="event-detail">
    <div class="event-detail-header">
      <button class="event-detail-back" onclick="closeEventDetail()" aria-label="뒤로 가기">← 뒤로</button>
      <span class="event-detail-title">메디셜 신규 회원 이벤트</span>
    </div>
    <div class="event-detail-body">
      <img src="img/benefit_01.jpg" alt="혜택 01" class="event-detail-img">
      <a href="https://meditial.co.kr/member/login.html?returnUrl=%2Fmyshop%2Fcoupon%2Fcoupon.html" target="_blank">
        <img src="img/benefit_02.gif" alt="쿠폰 받으러 가기" class="event-detail-img event-detail-cta">
      </a>
      <img src="img/benefit_03.jpg" alt="혜택 03" class="event-detail-img">
    </div>
  </div>
</div>

<!-- Challenge Detail -->
<div class="challenge-overlay" id="challengeOverlay">
  <div class="challenge-detail">
    <div class="challenge-detail-header">
      <button class="event-detail-back" onclick="closeChallengeDetail()" aria-label="뒤로 가기">← 뒤로</button>
      <span class="event-detail-title">작심삼월 챌린지</span>
    </div>
    <div class="challenge-detail-body" id="challengeBody"></div>
  </div>
</div>

<!-- Guide Popup -->
<div class="guide-popup-overlay" id="guidePopup">
  <div class="guide-popup-content">
    <div class="guide-popup-header">
      <span class="guide-popup-title">앱 사용법</span>
      <button class="guide-popup-close" onclick="closeGuidePopup()" aria-label="닫기">✕</button>
    </div>
    <div class="guide-popup-body">
      <div class="guide-popup-notice">
        이 앱은 <strong>홈 화면에 설치</strong>해서 사용해야 해요!<br>
        아래 방법으로 먼저 설치해 주세요.
      </div>

      <div class="guide-popup-section-title">아이폰 (iPhone) 설치 방법</div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">1</div>
        <div class="guide-popup-text"><strong>Safari</strong>에서 이 페이지를 열어요</div>
        <div class="guide-popup-emoji">🧭</div>
      </div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">2</div>
        <div class="guide-popup-text">화면 아래 <strong>공유 버튼</strong>을 눌러요</div>
        <div class="guide-popup-emoji">⬆️</div>
      </div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">3</div>
        <div class="guide-popup-text"><strong>홈 화면에 추가</strong>를 눌러요</div>
        <div class="guide-popup-emoji">➕</div>
      </div>

      <div class="guide-popup-section-title">갤럭시 (Android) 설치 방법</div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">1</div>
        <div class="guide-popup-text"><strong>Chrome</strong>에서 이 페이지를 열어요</div>
        <div class="guide-popup-emoji">🌐</div>
      </div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">2</div>
        <div class="guide-popup-text">화면 위 <strong>점 세 개 메뉴</strong>를 눌러요</div>
        <div class="guide-popup-emoji">⋮</div>
      </div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">3</div>
        <div class="guide-popup-text"><strong>홈 화면에 추가</strong>를 눌러요</div>
        <div class="guide-popup-emoji">➕</div>
      </div>

      <div class="guide-popup-divider"></div>
      <div class="guide-popup-section-title">앱 사용법</div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">1</div>
        <div class="guide-popup-text">아래 <strong>관리</strong> 탭에서<br><strong>+ 영양제 추가</strong>를 눌러 등록해요</div>
        <div class="guide-popup-emoji">⚙️</div>
      </div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">2</div>
        <div class="guide-popup-text"><strong>오늘</strong> 탭에서 영양제를 먹으면<br><strong>동그란 버튼</strong>을 눌러 체크해요</div>
        <div class="guide-popup-emoji">💊</div>
      </div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">3</div>
        <div class="guide-popup-text"><strong>통계</strong> 탭에서<br>내 기록을 확인할 수 있어요</div>
        <div class="guide-popup-emoji">📊</div>
      </div>
      <div class="guide-popup-step">
        <div class="guide-popup-num">4</div>
        <div class="guide-popup-text">재고가 <strong>3일분 이하</strong>가 되면<br><strong>빨간색</strong>으로 알려줘요</div>
        <div class="guide-popup-emoji">🔴</div>
      </div>
    </div>
    <button class="guide-popup-ok" onclick="closeGuidePopup()">알겠어요!</button>
  </div>
</div>

<!-- Coupon Popup -->
<div class="coupon-popup-overlay" id="couponPopup">
  <div class="coupon-popup-content">
    <span class="coupon-popup-icon">🎉</span>
    <div class="coupon-popup-title">앱 출시 기념 5000원 적립!</div>
    <div class="coupon-popup-code" id="couponCode">M01KBJF370</div>
    <div class="coupon-popup-desc">캡쳐하거나 복사하세요!</div>
    <button class="coupon-popup-copy" onclick="copyCouponCode()">쿠폰번호 복사</button>
    <a class="coupon-popup-link" href="https://meditial.co.kr/myshop/coupon/coupon.html" target="_blank">쿠폰 입력하러가기</a>
    <button class="coupon-popup-close" onclick="closeCouponPopup()">닫기</button>
  </div>
</div>

<!-- Badge Popup -->
<div class="badge-popup-overlay" id="badgePopup">
  <div class="badge-popup-content">
    <span class="badge-popup-icon" id="badgePopupIcon"></span>
    <div class="badge-popup-title">업적 달성!</div>
    <div class="badge-popup-reward">500원 추가적립!</div>
    <div class="badge-popup-name" id="badgePopupName"></div>
    <div class="badge-popup-desc" id="badgePopupDesc"></div>
    <button class="badge-popup-close" onclick="closeBadgePopup()">확인</button>
  </div>
</div>

<!-- Badge Detail Modal -->
<div class="badge-detail-overlay" id="badgeDetail">
  <div class="badge-detail-content" id="badgeDetailContent">
    <button class="badge-detail-close" onclick="closeBadgeDetail()" aria-label="닫기">✕</button>
    <span class="badge-detail-icon" id="badgeDetailIcon"></span>
    <div class="badge-detail-name" id="badgeDetailName"></div>
    <div class="badge-detail-desc" id="badgeDetailDesc"></div>
    <div class="badge-detail-status" id="badgeDetailStatus"></div>
  </div>
</div>

<!-- Past Complete Prompt -->
<div class="past-prompt-overlay" id="pastPrompt">
  <div class="past-prompt-content">
    <span class="past-prompt-icon">💊</span>
    <div class="past-prompt-text">오늘도 꼭 드실 거죠?</div>
    <button class="past-prompt-yes" onclick="closePastPromptAndGoToday()">YES</button>
  </div>
</div>

<!-- Install Banner (Android) -->
<div class="install-banner" id="installBannerAndroid" style="display:none;">
  <div class="install-banner-inner">
    <img src="icon.png" alt="앱 아이콘" class="install-banner-icon">
    <div class="install-banner-text">
      <strong>메디셜 영양제 체크</strong>
      <span>홈 화면에 추가하고 앱처럼 사용하세요!</span>
    </div>
    <div class="install-banner-actions">
      <button class="install-banner-btn" id="installBtn">설치</button>
      <button class="install-banner-close" id="installDismissAndroid" aria-label="닫기">✕</button>
    </div>
  </div>
</div>

<!-- Install Banner (iOS) -->
<div class="install-banner" id="installBannerIOS" style="display:none;">
  <div class="install-banner-inner">
    <img src="icon.png" alt="앱 아이콘" class="install-banner-icon">
    <div class="install-banner-text">
      <strong>메디셜 영양제 체크</strong>
      <span>사파리 하단 <strong>공유</strong> 버튼 → <strong>홈 화면에 추가</strong>를 눌러 설치하세요!</span>
    </div>
    <div class="install-banner-actions">
      <button class="install-banner-close" id="installDismissIOS" aria-label="닫기">✕</button>
    </div>
  </div>
</div>

<!-- Install Banner (In-App Browser → Safari) -->
<div class="install-banner" id="installBannerInApp" style="display:none;">
  <div class="install-banner-inner">
    <img src="icon.png" alt="앱 아이콘" class="install-banner-icon">
    <div class="install-banner-text">
      <strong>메디셜 영양제 체크</strong>
      <span>앱처럼 사용하려면 <strong>Safari</strong>에서 열어주세요!</span>
    </div>
    <div class="install-banner-actions">
      <button class="install-banner-btn" id="openSafariBtn">Safari에서 열기</button>
      <button class="install-banner-close" id="installDismissInApp" aria-label="닫기">✕</button>
    </div>
  </div>
</div>

<!-- Confetti container -->
<div class="confetti-container" id="confettiContainer"></div>

<!-- Modal -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <h2 id="modalTitle">영양제 추가</h2>
    <input type="hidden" id="editId">
    <div class="form-group">
      <label>이름</label>
      <select id="inputName" onchange="toggleCustomName()">
        <option value="">-- 선택하세요 --</option>
        <option value="블러드싸이클">블러드싸이클</option>
        <option value="헬리컷">헬리컷</option>
        <option value="판토오틴">판토오틴</option>
        <option value="글루타치온">글루타치온</option>
        <option value="멜라토닌">멜라토닌</option>
        <option value="혈당컷">혈당컷</option>
        <option value="활성엽산">활성엽산</option>
        <option value="상어연골환">상어연골환</option>
        <option value="__custom__">직접 입력</option>
      </select>
      <input type="text" id="inputCustomName" placeholder="영양제 이름을 입력하세요" style="display:none; margin-top:8px;">
    </div>
    <div class="form-group">
      <label>복용 시간</label>
      <input type="time" id="inputTime" value="09:00">
    </div>
    <div class="form-group">
      <label>복용량</label>
      <input type="text" id="inputDose" placeholder="예: 1정">
    </div>
    <div class="form-group">
      <label>재고 수량 (일분)</label>
      <input type="number" id="inputStock" min="0" value="30">
    </div>
    <div class="form-actions">
      <button class="btn-cancel" onclick="closeModal()">취소</button>
      <button class="btn-save" onclick="saveSupplement()">저장</button>
    </div>
  </div>
</div>

<script src="js/data.js"></script>
<script src="js/ui.js"></script>
<script src="js/badges.js"></script>
<script src="js/notifications.js"></script>
<script src="js/today.js"></script>
<script src="js/stats.js"></script>
<script src="js/manage.js"></script>
<script src="js/events.js"></script>
<script src="js/challenge.js"></script>
<script src="js/app.js"></script>
</body>
</html>
